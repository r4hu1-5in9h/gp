
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>master</title><meta name="generator" content="MATLAB 9.1"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2017-05-28"><meta name="DC.source" content="master.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">Load data</a></li><li><a href="#3">Compare optimization methods on subset of data</a></li><li><a href="#4">Implement chosen method on full data set</a></li><li><a href="#5">Visualize estimated quantiles</a></li></ul></div><pre class="codeinput"><span class="comment">% To run this code, first install the GPML code library</span>
<span class="comment">% The GPML code can be freely downloaded from</span>
<span class="comment">% http://www.gaussianprocess.org/gpml/code/matlab/doc/</span>
</pre><h2 id="2">Load data</h2><pre class="codeinput">close <span class="string">all</span>;
clear <span class="string">all</span>;
startup;
load(<span class="string">'../data/data_BHP2.mat'</span>);
data=[log_q log_p log_y];
</pre><pre class="codeoutput">executing gpml startup script...
</pre><h2 id="3">Compare optimization methods on subset of data</h2><pre class="codeinput">n_obs=100;
rng(3);
sample=datasample(data,n_obs,<span class="string">'Replace'</span>,false);
y=sample(:,1);
x1=sample(:,2);
x2=sample(:,3);

len=100;
quantiles = [0.25 0.50 0.75];
optimizers = {<span class="string">'sd'</span>,<span class="string">'bb'</span>,<span class="string">'pr'</span>,<span class="string">'lbfgs'</span>};

<span class="keyword">for</span> idq = 1:length(quantiles)

    quantileToPredict=quantiles(idq);

    tic;

    figure;
    <span class="keyword">for</span> ido = 1:length(optimizers)

        optimizer=optimizers{ido};
        fprintf(<span class="string">'quantile: %3.2f optimizer: %s\n'</span>,quantileToPredict,optimizer);

        [~,~,~,~,~,output]=save_quantile(quantileToPredict,len,optimizer,x1,x2,y);

        param_path=output.trace.param_path;
        n_iter=output.iterations;

        subplot(2,2,ido);
        scatter3(param_path(1,:),param_path(2,:),param_path(3,:),<span class="string">'filled'</span>);
        line(param_path(1,:),param_path(2,:),param_path(3,:));
        title(strcat(optimizers{ido},<span class="string">': '</span>,num2str(n_iter)));

    <span class="keyword">end</span>

    toc;

<span class="keyword">end</span>
</pre><pre class="codeoutput">quantile: 0.25 optimizer: sd
 Iteration   FunEvals     Step Length    Function Val        Opt Cond
         1          2     6.92698e-03     1.69931e+02     6.62057e+01
         2          3     1.97262e-02     1.11919e+02     1.25069e+01
         3          5     2.70680e-02     1.11398e+02     1.92311e+01
         4          6     2.56144e-03     1.10454e+02     1.52877e+01
         5          7     7.00680e-03     1.09057e+02     6.02233e+00
         6          9     1.91491e-02     1.08376e+02     5.06597e+00
         7         10     2.53899e-02     1.07885e+02     7.44871e+00
         8         11     1.28200e-02     1.07329e+02     4.25275e+00
         9         12     4.96502e-02     1.06594e+02     5.96683e+00
        10         14     1.45115e-02     1.06228e+02     3.55654e+00
        11         15     3.89486e-02     1.05928e+02     6.40694e+00
        12         16     1.17298e-02     1.05595e+02     2.99077e+00
        13         17     6.64740e-02     1.05138e+02     4.04709e+00
        14         19     1.30951e-02     1.05000e+02     1.90440e+00
        15         20     5.29541e-02     1.04911e+02     4.43018e+00
        16         21     8.18861e-03     1.04795e+02     1.27332e+00
        17         23     2.96725e-02     1.04751e+02     1.84986e+00
        18         24     1.77592e-02     1.04717e+02     1.38959e+00
        19         25     2.08305e-02     1.04691e+02     1.45454e+00
        20         26     1.59882e-02     1.04666e+02     8.39829e-01
        21         27     2.88601e-02     1.04646e+02     1.55110e+00
        22         28     1.19488e-02     1.04625e+02     6.72216e-01
        23         29     5.05474e-02     1.04595e+02     1.13061e+00
        24         31     1.44040e-02     1.04582e+02     5.06658e-01
        25         32     3.54485e-02     1.04571e+02     1.18816e+00
        26         33     1.25563e-02     1.04559e+02     4.21804e-01
        27         34     4.94746e-02     1.04545e+02     1.10864e+00
        28         35     1.69545e-02     1.04537e+02     7.41160e-01
        29         36     2.05386e-02     1.04531e+02     7.57494e-01
        30         37     1.39962e-02     1.04524e+02     3.50527e-01
        31         38     3.66225e-02     1.04518e+02     7.50256e-01
        32         39     1.71686e-02     1.04512e+02     5.16113e-01
        33         40     2.20757e-02     1.04508e+02     6.06002e-01
        34         41     1.45100e-02     1.04504e+02     3.13783e-01
        35         42     3.41450e-02     1.04499e+02     6.13529e-01
        36         43     1.69285e-02     1.04496e+02     4.07283e-01
        37         44     2.35871e-02     1.04493e+02     5.39379e-01
        38         45     1.36545e-02     1.04490e+02     2.80910e-01
        39         46     3.76942e-02     1.04486e+02     5.03495e-01
        40         47     2.08402e-02     1.04483e+02     5.26178e-01
        41         48     1.20058e-02     1.04481e+02     2.56949e-01
        42         49     4.61299e-02     1.04476e+02     3.29959e-01
        43         51     1.87323e-02     1.04474e+02     2.78388e-01
        44         52     2.29472e-02     1.04473e+02     3.47905e-01
        45         53     1.74449e-02     1.04471e+02     2.49325e-01
        46         54     2.46808e-02     1.04469e+02     3.53668e-01
        47         55     1.59962e-02     1.04468e+02     2.12753e-01
        48         56     2.87337e-02     1.04466e+02     3.67956e-01
        49         57     1.49113e-02     1.04465e+02     2.00928e-01
        50         58     3.28071e-02     1.04463e+02     3.79507e-01
        51         59     1.39330e-02     1.04462e+02     1.88986e-01
        52         60     3.83559e-02     1.04460e+02     3.86159e-01
        53         61     1.37532e-02     1.04459e+02     1.76618e-01
        54         62     4.09187e-02     1.04458e+02     4.07299e-01
        55         63     1.06586e-02     1.04457e+02     1.65045e-01
        56         64     6.29279e-02     1.04454e+02     1.51702e-01
        57         66     4.53048e-02     1.04453e+02     3.32786e-01
        58         67     1.39579e-02     1.04452e+02     1.40359e-01
        59         68     4.06407e-02     1.04452e+02     3.71297e-01
        60         69     6.43294e-03     1.04451e+02     1.36145e-01
        61         70     3.50497e-02     1.04451e+02     3.31145e-01
        62         71     6.13258e-03     1.04450e+02     1.31857e-01
        63         72     3.03868e-02     1.04450e+02     2.63085e-01
        64         73     9.32476e-03     1.04449e+02     1.18886e-01
        65         74     5.15924e-02     1.04448e+02     1.11065e-01
        66         76     3.29119e-02     1.04448e+02     1.96428e-01
        67         77     1.53880e-02     1.04447e+02     1.04345e-01
        68         78     3.05549e-02     1.04447e+02     2.01209e-01
        69         79     1.16911e-02     1.04447e+02     9.88534e-02
        70         80     4.89062e-02     1.04446e+02     1.15708e-01
        71         82     1.95082e-02     1.04446e+02     1.05715e-01
        72         83     2.17774e-02     1.04446e+02     1.21140e-01
        73         84     1.84526e-02     1.04445e+02     9.81101e-02
        74         85     2.25863e-02     1.04445e+02     1.20178e-01
        75         86     1.75783e-02     1.04445e+02     8.70512e-02
        76         87     2.43457e-02     1.04445e+02     1.21797e-01
        77         88     1.64556e-02     1.04444e+02     7.75957e-02
        78         89     2.70991e-02     1.04444e+02     1.25213e-01
        79         90     1.53677e-02     1.04444e+02     7.34855e-02
        80         91     3.07136e-02     1.04444e+02     1.29034e-01
        81         92     1.45648e-02     1.04444e+02     6.94142e-02
        82         93     3.42896e-02     1.04444e+02     1.32338e-01
        83         94     1.36546e-02     1.04443e+02     6.53242e-02
        84         95     4.00111e-02     1.04443e+02     1.32807e-01
        85         96     1.41805e-02     1.04443e+02     6.09998e-02
        86         97     3.78522e-02     1.04443e+02     1.42440e-01
        87         98     8.94269e-03     1.04443e+02     5.74488e-02
        88         99     5.65649e-02     1.04443e+02     7.77962e-02
        89        101     1.70831e-02     1.04443e+02     5.30236e-02
        90        102     2.57139e-02     1.04442e+02     8.04906e-02
        91        103     1.61966e-02     1.04442e+02     4.96418e-02
        92        104     2.78321e-02     1.04442e+02     8.25352e-02
        93        105     1.49344e-02     1.04442e+02     4.70786e-02
        94        106     3.25005e-02     1.04442e+02     8.45733e-02
        95        107     1.48139e-02     1.04442e+02     4.43952e-02
        96        108     3.32885e-02     1.04442e+02     8.74675e-02
        97        109     1.23172e-02     1.04442e+02     4.19693e-02
        98        110     4.76066e-02     1.04442e+02     6.74340e-02
        99        111     2.88532e-02     1.04442e+02     1.24134e-01
       100        112     1.24981e-03     1.04442e+02     1.08863e-01
Reached Maximum Number of Iterations
quantile: 0.25 optimizer: bb
 Iteration   FunEvals     Step Length    Function Val        Opt Cond
         1          2     6.92702e-03     1.69932e+02     6.62055e+01
         2          3     1.00000e+00     1.12269e+02     1.62819e+01
         3          4     1.00000e+00     1.10487e+02     1.13459e+01
         4          5     1.00000e+00     1.09283e+02     5.48044e+00
         5          6     1.00000e+00     1.08837e+02     5.19958e+00
         6          7     1.00000e+00     1.07195e+02     4.17050e+00
         7          8     1.00000e+00     1.05322e+02     2.59642e+00
         8          9     1.00000e+00     1.06911e+02     1.92473e+01
         9         10     1.00000e+00     1.04731e+02     1.39711e+00
        10         11     1.00000e+00     1.04706e+02     9.17640e-01
        11         12     1.00000e+00     1.04692e+02     8.73419e-01
        12         13     1.00000e+00     1.04661e+02     7.65800e-01
        13         14     1.00000e+00     1.04507e+02     3.71736e-01
        14         15     1.00000e+00     1.04581e+02     4.72089e+00
        15         16     1.00000e+00     1.04464e+02     4.60222e-01
        16         17     1.00000e+00     1.04462e+02     2.15915e-01
        17         18     1.00000e+00     1.04462e+02     2.12239e-01
        18         19     1.00000e+00     1.04459e+02     1.91587e-01
        19         20     1.00000e+00     1.04443e+02     7.72444e-02
        20         21     1.00000e+00     1.04444e+02     1.87316e-01
        21         22     1.00000e+00     1.04460e+02     1.93785e+00
        22         23     1.00000e+00     1.04441e+02     1.13200e-01
        23         24     1.00000e+00     1.04441e+02     2.92968e-02
        24         25     1.00000e+00     1.04441e+02     2.69791e-02
        25         26     1.00000e+00     1.04441e+02     8.99806e-03
        26         27     1.00000e+00     1.04441e+02     7.07129e-03
        27         28     1.00000e+00     1.04441e+02     6.36866e-02
        28         29     1.00000e+00     1.04441e+02     8.20637e-03
        29         30     1.00000e+00     1.04441e+02     4.79261e-03
        30         31     1.00000e+00     1.04441e+02     4.73576e-03
        31         32     1.00000e+00     1.04441e+02     2.07460e-04
        32         33     1.00000e+00     1.04441e+02     1.74072e-02
        33         34     1.00000e+00     1.04441e+02     2.64372e-04
        34         35     1.00000e+00     1.04441e+02     1.31466e-04
Function Value changing by less than progTol
quantile: 0.25 optimizer: pr
 Iteration   FunEvals     Step Length    Function Val        Opt Cond
         1          3     2.42150e-02     1.09981e+02     9.29030e+00
         2          5     6.96348e-01     1.09102e+02     5.46613e+00
         3          7     2.12267e+00     1.08332e+02     1.37054e+01
         4          9     1.95461e+00     1.06836e+02     1.90260e+01
         5         12     1.73342e+00     1.04573e+02     1.24083e+00
         6         14     3.55737e+00     1.04559e+02     3.56054e-01
         7         17     4.44532e+00     1.04553e+02     1.03915e+00
         8         21     6.24737e+00     1.04452e+02     3.50338e-01
         9         25     2.62848e-02     1.04452e+02     3.46058e-01
        10         26     1.64139e-02     1.04452e+02     3.35649e-01
        11         29     5.47904e-01     1.04447e+02     2.11837e-01
        12         30     1.00000e+00     1.04442e+02     1.77286e-01
        13         32     1.66195e+00     1.04441e+02     5.81694e-02
        14         34     2.87893e+00     1.04441e+02     5.64242e-02
        15         35     1.00000e+00     1.04441e+02     1.83634e-02
        16         36     1.00000e+00     1.04441e+02     7.74570e-03
        17         37     1.00000e+00     1.04441e+02     1.50804e-03
        18         38     1.00000e+00     1.04441e+02     4.98577e-04
        19         39     1.00000e+00     1.04441e+02     7.21064e-06
Optimality Condition below optTol
quantile: 0.25 optimizer: lbfgs
 Iteration   FunEvals     Step Length    Function Val        Opt Cond
         1          2     6.92671e-03     1.69932e+02     6.62071e+01
         2          4     4.38384e-01     1.18195e+02     3.12198e+01
         3          5     1.00000e+00     1.13089e+02     1.32537e+01
         4          6     1.00000e+00     1.10752e+02     7.02154e+00
         5          7     1.00000e+00     1.08501e+02     4.93398e+00
         6          8     1.00000e+00     1.07003e+02     4.20699e+00
         7          9     1.00000e+00     1.04698e+02     2.32255e+00
         8         10     1.00000e+00     1.04499e+02     4.34107e-01
         9         11     1.00000e+00     1.04472e+02     2.77426e-01
        10         12     1.00000e+00     1.04458e+02     3.19152e-01
        11         13     1.00000e+00     1.04445e+02     2.39050e-01
        12         14     1.00000e+00     1.04441e+02     6.27182e-02
        13         15     1.00000e+00     1.04441e+02     7.53836e-03
        14         16     1.00000e+00     1.04441e+02     4.85667e-03
        15         17     1.00000e+00     1.04441e+02     6.14837e-03
        16         18     1.00000e+00     1.04441e+02     1.56419e-03
        17         19     1.00000e+00     1.04441e+02     1.31160e-04
Directional Derivative below progTol
Elapsed time is 11.114531 seconds.
quantile: 0.50 optimizer: sd
 Iteration   FunEvals     Step Length    Function Val        Opt Cond
         1          2     6.17206e-03     1.55419e+02     6.19390e+01
         2          3     2.08144e-02     1.08405e+02     2.74456e+01
         3          5     1.27816e-02     1.04859e+02     9.35926e+00
         4          7     1.53620e-02     1.03829e+02     4.85691e+00
         5          8     4.06715e-02     1.03357e+02     1.17193e+01
         6          9     6.04546e-03     1.02637e+02     5.41124e+00
         7         11     1.62136e-02     1.02251e+02     3.55074e+00
         8         12     3.09378e-02     1.01928e+02     5.98840e+00
         9         13     1.29320e-02     1.01569e+02     3.35737e+00
        10         14     4.66629e-02     1.01074e+02     4.92830e+00
        11         15     2.69306e-02     1.00944e+02     8.28017e+00
        12         16     3.22994e-03     1.00721e+02     5.47056e+00
        13         17     1.06413e-02     1.00450e+02     3.14733e+00
        14         18     4.69789e-02     9.99508e+01     2.78850e+00
        15         19     9.08087e-02     9.98596e+01     1.05974e+01
        16         20     1.56880e-03     9.96894e+01     9.12527e+00
        17         21     3.90184e-03     9.94061e+01     5.88930e+00
        18         22     1.46414e-02     9.91938e+01     2.43760e+00
        19         24     1.62603e-02     9.91143e+01     1.57321e+00
        20         25     2.76614e-02     9.90433e+01     2.60150e+00
        21         26     1.44021e-02     9.89728e+01     1.37344e+00
        22         27     3.43420e-02     9.89094e+01     2.71152e+00
        23         28     1.28871e-02     9.88445e+01     1.20582e+00
        24         29     4.44673e-02     9.87771e+01     2.63553e+00
        25         30     1.50693e-02     9.87216e+01     1.31751e+00
        26         31     3.07082e-02     9.86921e+01     2.68675e+00
        27         32     6.57294e-03     9.86489e+01     9.85304e-01
        28         33     3.40703e-02     9.86116e+01     2.14158e+00
        29         34     1.21799e-02     9.85702e+01     9.13630e-01
        30         35     4.94580e-02     9.85094e+01     1.57576e+00
        31         37     1.56433e-02     9.84793e+01     8.42371e-01
        32         38     2.96603e-02     9.84508e+01     1.61954e+00
        33         39     1.48130e-02     9.84219e+01     8.00727e-01
        34         40     3.30965e-02     9.83939e+01     1.65609e+00
        35         41     1.44733e-02     9.83659e+01     7.68157e-01
        36         42     3.49856e-02     9.83398e+01     1.69851e+00
        37         43     1.32716e-02     9.83124e+01     7.41662e-01
        38         44     4.21896e-02     9.82813e+01     1.61139e+00
        39         45     1.74145e-02     9.82578e+01     1.14925e+00
        40         46     2.06582e-02     9.82388e+01     1.19478e+00
        41         47     1.61121e-02     9.82190e+01     7.05299e-01
        42         48     2.81471e-02     9.81988e+01     1.23929e+00
        43         49     1.66783e-02     9.81795e+01     7.94697e-01
        44         50     2.57650e-02     9.81617e+01     1.22369e+00
        45         51     1.52161e-02     9.81430e+01     6.84138e-01
        46         52     3.09041e-02     9.81234e+01     1.24179e+00
        47         53     1.66884e-02     9.81052e+01     7.97969e-01
        48         54     2.52498e-02     9.80891e+01     1.18728e+00
        49         55     1.47098e-02     9.80718e+01     6.71823e-01
        50         56     3.27234e-02     9.80523e+01     1.17648e+00
        51         57     1.82753e-02     9.80359e+01     9.42784e-01
        52         58     2.00000e-02     9.80209e+01     9.19431e-01
        53         59     1.90243e-02     9.80059e+01     8.05869e-01
        54         60     2.17811e-02     9.79912e+01     9.25773e-01
        55         61     1.86499e-02     9.79766e+01     7.76919e-01
        56         62     2.23430e-02     9.79622e+01     9.35639e-01
        57         63     1.82438e-02     9.79478e+01     7.47704e-01
        58         64     2.29818e-02     9.79337e+01     9.46788e-01
        59         65     1.78720e-02     9.79195e+01     7.21393e-01
        60         66     2.36269e-02     9.79055e+01     9.59034e-01
        61         67     1.75276e-02     9.78915e+01     6.97913e-01
        62         68     2.42492e-02     9.78777e+01     9.70413e-01
        63         69     1.72245e-02     9.78639e+01     6.77587e-01
        64         70     2.48365e-02     9.78502e+01     9.81269e-01
        65         71     1.69438e-02     9.78365e+01     6.65013e-01
        66         72     2.54618e-02     9.78229e+01     9.92351e-01
        67         73     1.67111e-02     9.78092e+01     6.66292e-01
        68         74     2.59934e-02     9.77957e+01     1.00297e+00
        69         75     1.64656e-02     9.77822e+01     6.67666e-01
        70         76     2.66093e-02     9.77687e+01     1.01295e+00
        71         77     1.62979e-02     9.77552e+01     6.69260e-01
        72         78     2.70430e-02     9.77418e+01     1.02190e+00
        73         79     1.60896e-02     9.77284e+01     6.70662e-01
        74         80     2.76488e-02     9.77150e+01     1.03112e+00
        75         81     1.59666e-02     9.77016e+01     6.72016e-01
        76         82     2.79933e-02     9.76883e+01     1.03870e+00
        77         83     1.57698e-02     9.76749e+01     6.73147e-01
        78         84     2.86555e-02     9.76616e+01     1.04788e+00
        79         85     1.56901e-02     9.76483e+01     6.74184e-01
        80         86     2.88735e-02     9.76351e+01     1.05518e+00
        81         87     1.54474e-02     9.76218e+01     6.74766e-01
        82         88     2.97701e-02     9.76085e+01     1.06328e+00
        83         89     1.55233e-02     9.75952e+01     6.75000e-01
        84         90     2.94461e-02     9.75822e+01     1.06956e+00
        85         91     1.50316e-02     9.75690e+01     6.75031e-01
        86         92     3.13963e-02     9.75554e+01     1.07468e+00
        87         93     1.57231e-02     9.75422e+01     6.74450e-01
        88         94     2.86053e-02     9.75299e+01     1.07214e+00
        89         95     1.42676e-02     9.75169e+01     6.73527e-01
        90         96     3.44989e-02     9.75020e+01     1.03990e+00
        91         97     1.82067e-02     9.74897e+01     8.28263e-01
        92         98     1.97221e-02     9.74783e+01     7.85957e-01
        93         99     1.92961e-02     9.74670e+01     7.11214e-01
        94        100     2.13671e-02     9.74558e+01     7.89803e-01
        95        101     1.90636e-02     9.74446e+01     6.96471e-01
        96        102     2.16975e-02     9.74336e+01     7.95856e-01
        97        103     1.88280e-02     9.74225e+01     6.83379e-01
        98        104     2.20089e-02     9.74115e+01     8.01973e-01
        99        105     1.85762e-02     9.74005e+01     6.68304e-01
       100        106     2.23905e-02     9.73897e+01     8.09298e-01
Reached Maximum Number of Iterations
quantile: 0.50 optimizer: bb
 Iteration   FunEvals     Step Length    Function Val        Opt Cond
         1          2     6.17224e-03     1.55419e+02     6.19382e+01
         2          3     1.00000e+00     1.10074e+02     1.99280e+01
         3          4     1.00000e+00     1.06173e+02     1.67527e+01
         4          5     1.00000e+00     1.04264e+02     5.18095e+00
         5          6     1.00000e+00     1.03789e+02     4.81715e+00
         6          7     1.00000e+00     1.03297e+02     4.39080e+00
         7          8     1.00000e+00     1.01571e+02     3.32747e+00
         8          9     1.00000e+00     1.00171e+02     4.25869e+00
         9         10     1.00000e+00     9.99700e+01     3.74538e+00
        10         11     1.00000e+00     9.98081e+01     2.64370e+00
        11         12     1.00000e+00     9.97220e+01     2.54379e+00
        12         13     1.00000e+00     9.84981e+01     7.70106e-01
        13         14     1.00000e+00     9.83075e+01     5.70785e+00
        14         15     1.00000e+00     9.82279e+01     4.82575e+00
        15         16     1.00000e+00     9.81022e+01     7.02299e-01
        16         17     1.00000e+00     9.80914e+01     6.99937e-01
        17         18     1.00000e+00     9.80728e+01     6.95533e-01
        18         19     1.00000e+00     9.78754e+01     6.60077e-01
        19         20     1.00000e+00     9.77263e+01     6.73761e-01
        20         21     1.00000e+00     9.76878e+01     2.70120e+00
        21         22     1.00000e+00     9.76438e+01     6.75192e-01
        22         23     1.00000e+00     9.76374e+01     6.74974e-01
        23         24     1.00000e+00     9.76275e+01     6.74971e-01
        24         25     1.00000e+00     9.68667e+01     4.27268e-01
        25         26     1.00000e+00     1.01258e+02     3.32981e+01
        26         27     1.00000e+00     9.66847e+01     2.40084e+00
        27         28     1.00000e+00     9.66507e+01     7.00284e-01
        28         29     1.00000e+00     9.66445e+01     6.83896e-01
        29         30     1.00000e+00     9.66387e+01     6.66780e-01
        30         31     1.00000e+00     9.65308e+01     1.06871e-01
        31         32     1.00000e+00     9.65397e+01     1.63675e+00
        32         33     1.00000e+00     9.65259e+01     1.00359e-01
        33         34     1.00000e+00     9.65258e+01     1.00196e-01
        34         35     1.00000e+00     9.65257e+01     1.00014e-01
        35         36     1.00000e+00     9.65088e+01     7.05204e-02
        36         37     1.00000e+00     9.64908e+01     7.27267e-01
        37         38     1.00000e+00     9.65360e+01     3.05976e+00
        38         39     1.00000e+00     9.64877e+01     7.25728e-02
        39         40     1.00000e+00     9.64876e+01     7.08551e-02
        40         41     1.00000e+00     9.64875e+01     6.72721e-02
        41         42     1.00000e+00     9.64861e+01     2.90410e-02
        42         43     1.00000e+00     9.64860e+01     1.86282e-01
        43         44     1.00000e+00     9.64858e+01     2.83755e-02
        44         45     1.00000e+00     9.64858e+01     2.83605e-02
        45         46     1.00000e+00     9.64858e+01     2.83444e-02
        46         47     1.00000e+00     9.64768e+01     1.07740e-02
        47         48     1.00000e+00     9.65263e+01     9.40455e-01
        48         50     1.33871e-01     9.65190e+01     4.82830e-01
        49         51     1.00000e+00     9.65163e+01     4.68681e-01
        50         52     1.00000e+00     9.65139e+01     4.53151e-01
        51         53     1.00000e+00     9.64760e+01     5.29353e-02
        52         54     1.00000e+00     9.64753e+01     1.10800e-01
        53         55     1.00000e+00     9.64778e+01     7.11529e-01
        54         56     1.00000e+00     9.64752e+01     1.29566e-02
        55         57     1.00000e+00     9.64752e+01     1.29141e-02
        56         58     1.00000e+00     9.64752e+01     1.27212e-02
        57         59     1.00000e+00     9.64751e+01     1.04600e-02
        58         60     1.00000e+00     9.64751e+01     9.64350e-02
        59         61     1.00000e+00     9.64750e+01     1.34835e-02
        60         62     1.00000e+00     9.64750e+01     9.35364e-03
        61         63     1.00000e+00     9.64750e+01     9.33237e-03
        62         64     1.00000e+00     9.64747e+01     6.57527e-03
        63         65     1.00000e+00     9.64747e+01     2.02703e-02
        64         66     1.00000e+00     9.64749e+01     2.68243e-01
        65         67     1.00000e+00     9.64746e+01     6.95873e-02
        66         68     1.00000e+00     9.64746e+01     6.29662e-03
        67         69     1.00000e+00     9.64746e+01     6.29544e-03
        68         70     1.00000e+00     9.64746e+01     6.29013e-03
        69         71     1.00000e+00     9.64745e+01     6.23376e-03
        70         72     1.00000e+00     9.64745e+01     1.60012e-02
        71         73     1.00000e+00     9.64745e+01     6.18569e-03
        72         74     1.00000e+00     9.64745e+01     6.18481e-03
        73         75     1.00000e+00     9.64745e+01     6.18401e-03
        74         76     1.00000e+00     9.64744e+01     5.92743e-03
        75         77     1.00000e+00     9.64743e+01     8.32942e-03
        76         78     1.00000e+00     9.64744e+01     1.77442e-01
        77         79     1.00000e+00     9.64743e+01     1.31689e-02
        78         80     1.00000e+00     9.64743e+01     5.67915e-03
        79         81     1.00000e+00     9.64743e+01     5.67838e-03
        80         82     1.00000e+00     9.64742e+01     5.64997e-03
        81         83     1.00000e+00     9.64742e+01     5.61364e-03
        82         84     1.00000e+00     9.64742e+01     1.66616e-02
        83         85     1.00000e+00     9.64742e+01     5.59665e-03
        84         86     1.00000e+00     9.64742e+01     5.59599e-03
        85         87     1.00000e+00     9.64742e+01     5.59523e-03
        86         88     1.00000e+00     9.64733e+01     3.70176e-03
        87         90     5.19040e-03     9.64733e+01     2.26823e-02
        88         91     1.00000e+00     9.64733e+01     3.68791e-03
        89         92     1.00000e+00     9.64733e+01     3.68767e-03
        90         93     1.00000e+00     9.64733e+01     3.68739e-03
        91         94     1.00000e+00     9.64732e+01     3.67157e-03
        92         95     1.00000e+00     9.64732e+01     3.59766e-03
        93         96     1.00000e+00     9.64733e+01     1.59260e-01
        94         97     1.00000e+00     9.64732e+01     3.48079e-03
        95         98     1.00000e+00     9.64732e+01     3.48059e-03
        96         99     1.00000e+00     9.64732e+01     3.48046e-03
        97        100     1.00000e+00     9.64731e+01     3.47451e-03
        98        101     1.00000e+00     9.64731e+01     3.46391e-03
        99        102     1.00000e+00     9.64731e+01     9.70466e-03
       100        103     1.00000e+00     9.64731e+01     3.44831e-03
Reached Maximum Number of Iterations
quantile: 0.50 optimizer: pr
 Iteration   FunEvals     Step Length    Function Val        Opt Cond
         1          3     2.33106e-02     1.04858e+02     1.51092e+01
         2          5     5.84678e-01     1.03473e+02     4.74101e+00
         3          7     5.78917e+00     1.02441e+02     1.15841e+01
         4          9     1.27358e+00     1.00912e+02     1.76227e+01
         5         12     2.45278e+00     9.81868e+01     4.92624e+00
         6         14     2.16875e+00     9.74348e+01     5.25784e+00
         7         16     2.67340e+00     9.70876e+01     3.70271e+00
         8         18     1.65886e+00     9.68019e+01     1.34372e+00
         9         20     5.50500e+00     9.66328e+01     3.58921e+00
        10         22     1.87241e+00     9.65543e+01     2.45611e-01
        11         24     3.90845e+00     9.65508e+01     8.05693e-01
        12         26     5.50500e+00     9.65449e+01     8.67487e-01
        13         28     1.58781e+00     9.65394e+01     3.51024e-02
        14         30     1.71605e+00     9.65394e+01     7.08984e-03
        15         33     5.55311e+00     9.65394e+01     3.10439e-02
        16         35     1.57589e+00     9.65394e+01     6.26010e-02
        17         37     4.86990e+00     9.65393e+01     2.34184e-02
        18         38     1.00000e+00     9.65393e+01     1.73444e-03
        19         41     1.74328e+00     9.65393e+01     1.88532e-03
        20         50     1.43479e+00     9.65393e+01     1.45273e-03
        21         53     1.75958e+00     9.65393e+01     5.19317e-03
        22         60     1.11798e+00     9.65393e+01     6.24277e-03
        23         62     4.50585e+00     9.65393e+01     6.51495e-04
        24         65     1.29652e+00     9.65393e+01     1.78234e-03
        25         67     1.76181e+00     9.65393e+01     1.84682e-04
Directional Derivative below progTol
quantile: 0.50 optimizer: lbfgs
 Iteration   FunEvals     Step Length    Function Val        Opt Cond
         1          2     6.17212e-03     1.55419e+02     6.19396e+01
         2          4     5.82296e-01     1.08041e+02     1.23563e+01
         3          5     1.00000e+00     1.05931e+02     8.20295e+00
         4          6     1.00000e+00     1.02528e+02     3.73761e+00
         5          7     1.00000e+00     1.00527e+02     3.17749e+00
         6          8     1.00000e+00     9.80450e+01     1.05029e+00
         7          9     1.00000e+00     9.74667e+01     6.89350e-01
         8         10     1.00000e+00     9.65853e+01     1.40335e+00
         9         11     1.00000e+00     9.65293e+01     6.77048e-01
        10         12     1.00000e+00     9.65053e+01     6.53003e-01
        11         13     1.00000e+00     9.64947e+01     5.81739e-02
        12         14     1.00000e+00     9.64939e+01     3.87808e-02
        13         15     1.00000e+00     9.64933e+01     5.50806e-02
        14         16     1.00000e+00     9.64909e+01     1.12880e-01
        15         17     1.00000e+00     9.64871e+01     1.55126e-01
        16         18     1.00000e+00     9.64820e+01     1.54419e-01
        17         19     1.00000e+00     9.64769e+01     1.45641e-01
        18         20     1.00000e+00     9.64746e+01     1.46621e-02
        19         21     1.00000e+00     9.64734e+01     7.66037e-02
        20         22     1.00000e+00     9.64724e+01     6.62766e-02
        21         23     1.00000e+00     9.64719e+01     1.58778e-02
        22         24     1.00000e+00     9.64717e+01     1.22360e-02
        23         25     1.00000e+00     9.64716e+01     1.75175e-02
        24         26     1.00000e+00     9.64715e+01     1.08567e-02
        25         27     1.00000e+00     9.64714e+01     1.00686e-03
        26         28     1.00000e+00     9.64714e+01     3.41921e-03
        27         29     1.00000e+00     9.64714e+01     3.35875e-03
        28         30     1.00000e+00     9.64714e+01     7.11082e-03
        29         31     1.00000e+00     9.64714e+01     7.09479e-04
        30         32     1.00000e+00     9.64714e+01     2.00524e-03
        31         33     1.00000e+00     9.64714e+01     1.36282e-03
        32         34     1.00000e+00     9.64714e+01     8.66044e-05
        33         35     1.00000e+00     9.64714e+01     4.11838e-04
        34         36     1.00000e+00     9.64714e+01     3.28448e-04
        35         37     1.00000e+00     9.64714e+01     6.64221e-05
        36         38     1.00000e+00     9.64714e+01     6.56937e-05
        37         39     1.00000e+00     9.64714e+01     7.66837e-05
        38         40     1.00000e+00     9.64714e+01     1.41099e-05
        39         41     1.00000e+00     9.64714e+01     1.31750e-05
        40         42     1.00000e+00     9.64714e+01     1.64808e-05
Directional Derivative below progTol
Elapsed time is 14.621398 seconds.
quantile: 0.75 optimizer: sd
 Iteration   FunEvals     Step Length    Function Val        Opt Cond
         1          2     5.40038e-03     1.78893e+02     7.08630e+01
         2          3     1.80864e-02     1.08773e+02     7.83204e+00
Warning: Inference method failed [Error using likALD (line 74)
check] .. attempting to continue 
Warning: Inference method failed [Error using likALD (line 74)
check] .. attempting to continue 
         3          7     4.74340e-02     1.06481e+02     1.53186e+01
         4          8     1.72642e-02     1.05540e+02     1.08810e+01
         5          9     1.31629e-02     1.04593e+02     4.49802e+00
         6         10     6.64678e-02     1.04093e+02     1.24679e+01
         7         11     5.91254e-03     1.03331e+02     5.94605e+00
         8         13     1.42814e-02     1.02978e+02     3.31002e+00
         9         14     4.12367e-02     1.02710e+02     6.48118e+00
        10         15     1.06778e-02     1.02399e+02     2.53395e+00
        11         16     8.21754e-02     1.01923e+02     1.19185e+00
        12         18     6.68596e-02     1.01834e+02     3.06748e+00
        13         19     1.65858e-02     1.01786e+02     1.95393e+00
        14         20     1.92569e-02     1.01760e+02     1.73555e+00
        15         21     1.29275e-02     1.01733e+02     7.54644e-01
        16         22     4.51846e-02     1.01704e+02     1.67032e+00
        17         23     1.59734e-02     1.01683e+02     9.56121e-01
        18         24     2.62313e-02     1.01671e+02     1.51426e+00
        19         25     7.97129e-03     1.01655e+02     6.88416e-01
        20         26     4.37855e-02     1.01633e+02     1.04262e+00
        21         27     2.67673e-02     1.01628e+02     1.70738e+00
        22         28     3.17454e-03     1.01618e+02     1.16701e+00
        23         29     1.00676e-02     1.01606e+02     6.37392e-01
        24         31     4.84607e-01     1.01440e+02     3.69365e-01
        25         33     2.71699e-02     1.01436e+02     5.29438e-01
        26         34     1.67411e-02     1.01433e+02     3.56999e-01
        27         35     2.58630e-02     1.01429e+02     5.24677e-01
        28         36     1.47584e-02     1.01426e+02     3.45006e-01
        29         37     3.31380e-02     1.01423e+02     5.31189e-01
        30         38     1.63131e-02     1.01420e+02     3.30690e-01
        31         39     2.64967e-02     1.01418e+02     5.10735e-01
        32         40     1.27526e-02     1.01415e+02     3.19164e-01
        33         41     4.19261e-02     1.01411e+02     4.02998e-01
        34         42     2.91571e-02     1.01410e+02     7.48340e-01
        35         43     2.73426e-03     1.01408e+02     5.49018e-01
        36         44     8.01068e-03     1.01406e+02     2.96147e-01
        37         45     4.12863e-02     1.01403e+02     3.63486e-01
        38         46     2.92472e-02     1.01402e+02     6.78196e-01
        39         47     2.95132e-03     1.01401e+02     4.82890e-01
        40         48     8.92892e-03     1.01399e+02     2.74254e-01
        41         49     4.56002e-02     1.01396e+02     2.62357e-01
        42         51     2.60483e-02     1.01394e+02     3.30314e-01
        43         52     1.72034e-02     1.01393e+02     2.51864e-01
        44         53     2.49286e-02     1.01391e+02     3.27017e-01
        45         54     1.58364e-02     1.01390e+02     2.42531e-01
        46         55     2.92297e-02     1.01389e+02     3.37211e-01
        47         56     1.57219e-02     1.01387e+02     2.32545e-01
        48         57     2.94445e-02     1.01386e+02     3.43160e-01
        49         58     1.40309e-02     1.01385e+02     2.23312e-01
        50         59     3.68630e-02     1.01383e+02     3.35470e-01
        51         60     1.72060e-02     1.01382e+02     2.30464e-01
        52         61     2.26389e-02     1.01381e+02     2.80846e-01
        53         62     1.47776e-02     1.01380e+02     2.05063e-01
        54         63     3.29656e-02     1.01379e+02     2.80749e-01
        55         64     1.82570e-02     1.01378e+02     2.22057e-01
        56         65     2.01457e-02     1.01378e+02     2.16496e-01
        57         66     1.88570e-02     1.01377e+02     1.88523e-01
        58         67     2.21223e-02     1.01376e+02     2.14762e-01
        59         68     1.82681e-02     1.01375e+02     1.81622e-01
        60         69     2.31582e-02     1.01375e+02     2.15631e-01
        61         70     1.75204e-02     1.01374e+02     1.74959e-01
        62         71     2.46577e-02     1.01373e+02     2.19131e-01
        63         72     1.66523e-02     1.01373e+02     1.68471e-01
        64         73     2.67241e-02     1.01372e+02     2.24247e-01
        65         74     1.58429e-02     1.01371e+02     1.62071e-01
        66         75     2.91071e-02     1.01371e+02     2.29483e-01
        67         76     1.51613e-02     1.01370e+02     1.55642e-01
        68         77     3.16380e-02     1.01370e+02     2.34367e-01
        69         78     1.45065e-02     1.01369e+02     1.49197e-01
        70         79     3.48266e-02     1.01368e+02     2.38091e-01
        71         80     1.42047e-02     1.01368e+02     1.42717e-01
        72         81     3.69423e-02     1.01367e+02     2.44211e-01
        73         82     1.29154e-02     1.01367e+02     1.36435e-01
        74         83     4.55728e-02     1.01366e+02     2.24249e-01
        75         84     1.86002e-02     1.01366e+02     1.85054e-01
        76         85     1.60902e-02     1.01365e+02     1.27221e-01
        77         86     2.77461e-02     1.01365e+02     1.84546e-01
        78         87     1.39241e-02     1.01365e+02     1.22501e-01
        79         88     3.67566e-02     1.01364e+02     1.76124e-01
        80         89     1.89711e-02     1.01364e+02     1.51308e-01
        81         90     1.70785e-02     1.01364e+02     1.14283e-01
        82         91     2.50989e-02     1.01363e+02     1.49362e-01
        83         92     1.58221e-02     1.01363e+02     1.10222e-01
        84         93     2.92725e-02     1.01363e+02     1.53729e-01
        85         94     1.58466e-02     1.01363e+02     1.05854e-01
        86         95     2.88533e-02     1.01362e+02     1.55508e-01
        87         96     1.41081e-02     1.01362e+02     1.01913e-01
        88         97     3.63076e-02     1.01362e+02     1.52079e-01
        89         98     1.74221e-02     1.01361e+02     1.07890e-01
        90         99     2.19716e-02     1.01361e+02     1.24164e-01
        91        100     1.57422e-02     1.01361e+02     9.38939e-02
        92        101     2.96007e-02     1.01361e+02     1.28330e-01
        93        102     1.66799e-02     1.01361e+02     9.00648e-02
        94        103     2.57971e-02     1.01360e+02     1.24577e-01
        95        104     1.46175e-02     1.01360e+02     8.69679e-02
        96        105     3.37027e-02     1.01360e+02     1.24071e-01
        97        106     1.75718e-02     1.01360e+02     8.98929e-02
        98        107     2.20303e-02     1.01360e+02     1.03981e-01
        99        108     1.62467e-02     1.01360e+02     8.02707e-02
       100        109     2.80501e-02     1.01359e+02     1.07892e-01
Reached Maximum Number of Iterations
quantile: 0.75 optimizer: bb
 Iteration   FunEvals     Step Length    Function Val        Opt Cond
         1          2     5.40027e-03     1.78894e+02     7.08630e+01
         2          3     1.00000e+00     1.27226e+02     4.43542e+01
         3          4     1.00000e+00     1.18336e+02     5.32636e+01
         4          5     1.00000e+00     1.07822e+02     1.36758e+01
         5          6     1.00000e+00     1.06375e+02     5.90181e+00
         6          7     1.00000e+00     1.05841e+02     5.52475e+00
         7          8     1.00000e+00     1.05344e+02     5.11019e+00
         8          9     1.00000e+00     1.03152e+02     3.46817e+00
         9         10     1.00000e+00     1.02678e+02     1.23251e+01
        10         11     1.00000e+00     1.02255e+02     9.67787e+00
        11         12     1.00000e+00     1.01796e+02     7.89782e-01
        12         13     1.00000e+00     1.01782e+02     7.84059e-01
        13         14     1.00000e+00     1.01770e+02     7.76959e-01
        14         15     1.00000e+00     1.01634e+02     6.84523e-01
        15         16     1.00000e+00     1.01514e+02     6.94067e-01
        16         17     1.00000e+00     1.01620e+02     4.99546e+00
        17         18     1.00000e+00     1.01486e+02     4.70891e-01
        18         19     1.00000e+00     1.01484e+02     4.66816e-01
        19         20     1.00000e+00     1.01444e+02     3.89482e-01
        20         21     1.00000e+00     1.01357e+02     1.16678e-01
        21         22     1.00000e+00     1.01981e+02     1.12045e+01
        22         23     1.00000e+00     1.01384e+02     6.77506e-01
        23         24     1.00000e+00     1.01378e+02     4.92734e-01
        24         25     1.00000e+00     1.01375e+02     4.54824e-01
        25         26     1.00000e+00     1.01359e+02     1.84872e-01
        26         27     1.00000e+00     1.01356e+02     1.28561e-01
        27         28     1.00000e+00     1.01361e+02     9.75058e-01
        28         29     1.00000e+00     1.01356e+02     2.55550e-02
        29         30     1.00000e+00     1.01356e+02     2.45044e-02
        30         31     1.00000e+00     1.01356e+02     2.01320e-02
        31         32     1.00000e+00     1.01356e+02     3.24318e-02
        32         33     1.00000e+00     1.01356e+02     3.21416e-01
        33         34     1.00000e+00     1.01356e+02     9.48310e-04
        34         35     1.00000e+00     1.01356e+02     9.32648e-04
        35         36     1.00000e+00     1.01356e+02     8.13200e-04
        36         37     1.00000e+00     1.01356e+02     4.14178e-03
        37         38     1.00000e+00     1.01356e+02     7.41937e-04
        38         39     1.00000e+00     1.01356e+02     6.47870e-04
        39         40     1.00000e+00     1.01356e+02     6.41423e-04
        40         41     1.00000e+00     1.01356e+02     2.45118e-04
        41         42     1.00000e+00     1.01356e+02     4.06076e-04
        42         43     1.00000e+00     1.01356e+02     9.05304e-03
        43         44     1.00000e+00     1.01356e+02     1.18473e-04
Directional Derivative below progTol
quantile: 0.75 optimizer: pr
 Iteration   FunEvals     Step Length    Function Val        Opt Cond
         1          4     2.19744e-02     1.07350e+02     6.99015e+00
         2          6     8.02092e-01     1.06353e+02     6.30987e+00
         3          7     1.00000e+00     1.05656e+02     1.41203e+01
         4         10     9.73431e-01     1.04244e+02     1.88594e+01
         5         12     3.84795e-01     1.03447e+02     1.51270e+01
         6         14     1.08943e+00     1.02078e+02     2.65702e+00
         7         16     1.73233e+00     1.01796e+02     7.66851e-01
         8         18     3.54928e+00     1.01618e+02     1.06856e+00
         9         20     1.48544e+00     1.01465e+02     8.26815e-01
        10         22     1.35545e+00     1.01384e+02     4.30995e-01
        11         23     1.00000e+00     1.01360e+02     4.71653e-01
        12         24     1.00000e+00     1.01356e+02     8.77176e-02
        13         25     1.00000e+00     1.01356e+02     1.48191e-02
        14         26     1.00000e+00     1.01356e+02     9.92202e-04
        15         28     1.57230e+00     1.01356e+02     2.97973e-03
        16         29     1.00000e+00     1.01356e+02     2.67986e-05
Directional Derivative below progTol
quantile: 0.75 optimizer: lbfgs
 Iteration   FunEvals     Step Length    Function Val        Opt Cond
         1          2     5.40024e-03     1.78894e+02     7.08628e+01
         2          3     1.00000e+00     1.19332e+02     5.49139e+01
         3          4     1.00000e+00     1.11352e+02     2.15263e+01
         4          5     1.00000e+00     1.07662e+02     6.83841e+00
         5          6     1.00000e+00     1.06570e+02     6.03622e+00
         6          7     1.00000e+00     1.05364e+02     7.85592e+00
         7          8     1.00000e+00     1.02632e+02     6.68452e+00
         8          9     1.00000e+00     1.01769e+02     1.33119e+00
         9         10     1.00000e+00     1.01689e+02     5.84513e-01
        10         12     6.14111e-01     1.01589e+02     1.03450e+00
        11         13     1.00000e+00     1.01539e+02     9.31587e-01
        12         14     1.00000e+00     1.01356e+02     5.75136e-02
        13         15     1.00000e+00     1.01356e+02     3.20705e-02
        14         16     1.00000e+00     1.01356e+02     7.69277e-03
        15         17     1.00000e+00     1.01356e+02     5.45924e-03
        16         18     1.00000e+00     1.01356e+02     3.09480e-03
        17         19     1.00000e+00     1.01356e+02     9.46251e-04
        18         20     1.00000e+00     1.01356e+02     1.40045e-05
Function Value changing by less than progTol
Elapsed time is 10.882906 seconds.
</pre><img vspace="5" hspace="5" src="master_01.png" style="width:560px;height:420px;" alt=""> <img vspace="5" hspace="5" src="master_02.png" style="width:560px;height:420px;" alt=""> <img vspace="5" hspace="5" src="master_03.png" style="width:560px;height:420px;" alt=""> <h2 id="4">Implement chosen method on full data set</h2><pre class="codeinput">train=false;

<span class="keyword">if</span> train

    tic;
    ticBytes(gcp);
    <span class="keyword">for</span> ido = 1:numel(quantiles)
        quantileToPredict = quantiles(ido);
        optimizer=<span class="string">'sd'</span>;
        [~,~,~,~,~]=save_quantile(quantileToPredict,len,optimizer,x1,x2,y);
        optimizer=<span class="string">'pr'</span>;
        [~,~,~,~,~]=save_quantile(quantileToPredict,len,optimizer,x1,x2,y);
        optimizer=<span class="string">'lbfgs'</span>;
        [~,~,~,~,~]=save_quantile(quantileToPredict,len,optimizer,x1,x2,y);
        optimizer=<span class="string">'sr1'</span>;
        [~,~,~,~,~]=save_quantile(quantileToPredict,len,optimizer,x1,x2,y);
    <span class="keyword">end</span>
    tocBytes(gcp);
    toc;

<span class="keyword">end</span>
</pre><h2 id="5">Visualize estimated quantiles</h2><pre class="codeinput">load(<span class="string">'../data/results_0.25_100_sr1.mat'</span>);

CI_top=fmu_block+2.*sqrt(fs2_block);
CI_bottom=fmu_block-2.*sqrt(fs2_block);

figure;
scatter3(x1,x2,y,<span class="string">'filled'</span>);
hold <span class="string">on</span>;
mesh(x1_test,x2_test,fmu_block);
mesh(x1_test,x2_test,CI_top);
mesh(x1_test,x2_test,CI_bottom);
xlabel(<span class="string">'Price'</span>);
ylabel(<span class="string">'Income'</span>);
zlabel(<span class="string">'Demand'</span>);
<span class="comment">%view(30,10);</span>
hold <span class="string">off</span>;
</pre><img vspace="5" hspace="5" src="master_04.png" style="width:560px;height:420px;" alt=""> <p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2016b</a><br></p></div><!--
##### SOURCE BEGIN #####
% To run this code, first install the GPML code library
% The GPML code can be freely downloaded from
% http://www.gaussianprocess.org/gpml/code/matlab/doc/

%% Load data

close all; 
clear all;
startup;
load('../data/data_BHP2.mat');
data=[log_q log_p log_y];

%% Compare optimization methods on subset of data

n_obs=100;
rng(3);
sample=datasample(data,n_obs,'Replace',false);
y=sample(:,1);
x1=sample(:,2);
x2=sample(:,3);

len=100;
quantiles = [0.25 0.50 0.75];
optimizers = {'sd','bb','pr','lbfgs'};

for idq = 1:length(quantiles)
    
    quantileToPredict=quantiles(idq);
    
    tic;
    
    figure;
    for ido = 1:length(optimizers)
        
        optimizer=optimizers{ido};
        fprintf('quantile: %3.2f optimizer: %s\n',quantileToPredict,optimizer);
        
        [~,~,~,~,~,output]=save_quantile(quantileToPredict,len,optimizer,x1,x2,y);
        
        param_path=output.trace.param_path;
        n_iter=output.iterations;

        subplot(2,2,ido);
        scatter3(param_path(1,:),param_path(2,:),param_path(3,:),'filled');
        line(param_path(1,:),param_path(2,:),param_path(3,:));
        title(strcat(optimizers{ido},': ',num2str(n_iter)));
        
    end
    
    toc;
    
end


%% Implement chosen method on full data set

train=false;

if train

    tic;
    ticBytes(gcp);
    for ido = 1:numel(quantiles)
        quantileToPredict = quantiles(ido);
        optimizer='sd';
        [~,~,~,~,~]=save_quantile(quantileToPredict,len,optimizer,x1,x2,y);
        optimizer='pr';
        [~,~,~,~,~]=save_quantile(quantileToPredict,len,optimizer,x1,x2,y);
        optimizer='lbfgs';
        [~,~,~,~,~]=save_quantile(quantileToPredict,len,optimizer,x1,x2,y);
        optimizer='sr1';
        [~,~,~,~,~]=save_quantile(quantileToPredict,len,optimizer,x1,x2,y);
    end
    tocBytes(gcp);
    toc;

end

%% Visualize estimated quantiles
load('../data/results_0.25_100_sr1.mat');

CI_top=fmu_block+2.*sqrt(fs2_block);
CI_bottom=fmu_block-2.*sqrt(fs2_block);

figure;
scatter3(x1,x2,y,'filled');
hold on;
mesh(x1_test,x2_test,fmu_block);
mesh(x1_test,x2_test,CI_top);
mesh(x1_test,x2_test,CI_bottom);
xlabel('Price');
ylabel('Income');
zlabel('Demand');
%view(30,10);
hold off;

##### SOURCE END #####
--></body></html>